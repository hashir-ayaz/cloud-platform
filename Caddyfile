{
    # Global options
    admin localhost:2019
    auto_https off  # Disable HTTPS for local development
    email hashirayaz@gmail.com  # Use your email for SSL
}

# Proxy API routes to auth_service
http://localhost/api/auth/* {
    encode gzip  # Enable gzip compression
    reverse_proxy http://auth_service:5000 {
        header_up Host {http.reverse_proxy.upstream.hostport}
        header_up X-Real-IP {remote_host}
        header_up X-Forwarded-For {remote_host}
        header_up X-Forwarded-Proto {scheme}
    }
}

# Proxy API routes to container_service
http://localhost/api/* {
    encode gzip  # Enable gzip compression
    reverse_proxy http://container_service:5001 {
        header_up Host {http.reverse_proxy.upstream.hostport}
        header_up X-Real-IP {remote_host}
        header_up X-Forwarded-For {remote_host}
        header_up X-Forwarded-Proto {scheme}
    }
}

# Reverse proxy for the frontend with SPA fallback
http://localhost {
    encode gzip  # Enable gzip compression
    reverse_proxy http://frontend_container:4173 {
        header_up Host {http.reverse_proxy.upstream.hostport}
        header_up X-Real-IP {remote_host}
        header_up X-Forwarded-For {remote_host}
        header_up X-Forwarded-Proto {scheme}
    }
    try_files {path} /index.html  # Serve index.html for SPA routes
}
